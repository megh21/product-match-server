(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1717:(e,r,t)=>{Promise.resolve().then(t.bind(t,8365)),Promise.resolve().then(t.bind(t,8367)),Promise.resolve().then(t.bind(t,7200))},6810:(e,r,t)=>{"use strict";t.d(r,{Wu:()=>l,Zp:()=>i});var a=t(8081),s=t(2149),n=t(7687);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})}).displayName="CardHeader",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})}).displayName="CardTitle",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})}).displayName="CardDescription";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});l.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},7200:(e,r,t)=>{"use strict";t.d(r,{E:()=>l,ResultsProvider:()=>i});var a=t(8081),s=t(2149);let n=(0,s.createContext)(void 0),i=e=>{let{children:r}=e,[t,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(!1);return(0,a.jsx)(n.Provider,{value:{results:t,setResults:i,isLoading:l,setIsLoading:o},children:r})},l=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useResults must be used within a ResultsProvider");return e}},7687:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var a=t(6522),s=t(4483);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,a.$)(r))}},8365:(e,r,t)=>{"use strict";t.d(r,{default:()=>v});var a=t(8081),s=t(2149),n=t(9651),i=t(5186),l=t(7114),o=t(2522),d=t(2184),c=t(3047),u=t(5261),m=t(3484),f=t(7687);let g=(0,m.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),x=s.forwardRef((e,r)=>{let{className:t,variant:s,size:n,asChild:i=!1,...l}=e,o=i?u.DX:"button";return(0,a.jsx)(o,{className:(0,f.cn)(g({variant:s,size:n,className:t})),ref:r,...l})});x.displayName="Button";var p=t(6810),h=t(7200);function v(){let[e,r]=(0,s.useState)(null),[t,u]=(0,s.useState)(!1),m=(0,s.useRef)(null);(0,n.useRouter)();let{setResults:f,isLoading:g,setIsLoading:v}=(0,h.E)(),y=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?u(!0):"dragleave"===e.type&&u(!1)},b=e=>{let t=new FileReader;t.onload=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&r(e.target.result)},t.readAsDataURL(e)},j=async()=>{if(e)try{v(!0);let r=await fetch(e),t=await r.blob(),a=new File([t],"uploaded-image.jpg",{type:"image/jpeg"}),s=new FormData;s.append("image",a);let n=await fetch("/api/match?name=Query%20Product",{method:"POST",body:s,cache:"no-store"});if(!n.ok)throw Error("Failed to process image");let i=await n.json();f(i)}catch(e){console.error("Error uploading image:",e)}finally{v(!1)}};return(0,a.jsx)("div",{className:"mb-10",children:(0,a.jsx)(p.Zp,{className:"p-6 border-2 ".concat(t?"border-gray-400 bg-gray-50":"border-dashed border-gray-200"),onDragEnter:y,onDragLeave:y,onDragOver:y,onDrop:e=>{e.preventDefault(),e.stopPropagation(),u(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&b(e.dataTransfer.files[0])},children:e?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative aspect-video w-full max-h-[400px] overflow-hidden rounded-lg",children:[(0,a.jsx)(i.default,{src:e,alt:"Product preview",fill:!0,className:"object-contain",priority:!0}),(0,a.jsx)("button",{onClick:()=>{r(null),m.current&&(m.current.value="")},className:"absolute top-2 right-2 p-1 rounded-full bg-gray-800/70 text-white hover:bg-gray-900/90",children:(0,a.jsx)(o.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(x,{onClick:j,disabled:g,className:"flex items-center",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Find Similar Products"]})})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[(0,a.jsx)(l.A,{className:"h-12 w-12 text-gray-300 mb-4"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4 text-center",children:"Drag and drop your product image here, or click to select a file"}),(0,a.jsx)(x,{variant:"outline",onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},children:"Select Image"}),(0,a.jsx)("input",{ref:m,type:"file",className:"hidden",accept:"image/*",onChange:e=>{e.preventDefault(),e.target.files&&e.target.files[0]&&b(e.target.files[0])}})]})})})}},8367:(e,r,t)=>{"use strict";t.d(r,{default:()=>x});var a=t(8081),s=t(2149),n=t(5186),i=t(6810),l=t(3484),o=t(7687);let d=(0,l.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)(d({variant:t}),r),...s})}var u=t(2184),m=t(643),f=t(4404),g=t(7200);function x(){let{results:e,isLoading:r}=(0,g.E)(),[t,l]=(0,s.useState)({}),o=e=>{l(r=>({...r,[e]:!0}))};return e||r?(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Similar Products"}),r?(0,a.jsxs)("div",{className:"flex justify-center items-center py-20",children:[(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,a.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading recommendations..."})]}):e&&e.matches.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.matches.map((e,r)=>(0,a.jsxs)(i.Zp,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"relative h-48 w-full bg-gray-50",children:[t[e.product._id]?(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-4 text-gray-400",children:[(0,a.jsx)(m.A,{className:"h-10 w-10 mb-2"}),(0,a.jsx)("p",{className:"text-sm text-center",children:"Image not available"})]}):(0,a.jsx)(n.default,{src:e.product.image_url||"/placeholder.svg",alt:e.product.name,fill:!0,className:"object-contain p-2",onError:()=>o(e.product._id),unoptimized:!0,priority:r<3}),(0,a.jsxs)(c,{className:"absolute top-2 right-2 ".concat(e.similarity_score>80?"bg-green-500":e.similarity_score>60?"bg-yellow-500":"bg-orange-500"),children:[e.similarity_score,"% match"]})]}),(0,a.jsxs)(i.Wu,{className:"p-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.product.name}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[e.product.metadata.articleType," • ",e.product.metadata.baseColour]}),(0,a.jsxs)("span",{className:"font-medium",children:["$",e.product.cost.toFixed(2)]})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[e.product.metadata.gender," • ",e.product.metadata.masterCategory," •"," ",e.product.metadata.subCategory]})}),(0,a.jsxs)("a",{href:"#",className:"mt-3 text-sm text-gray-600 hover:text-gray-900 flex items-center",children:["View details",(0,a.jsx)(f.A,{className:"ml-1 h-3 w-3"})]})]})]},e.product._id))}):(0,a.jsx)("div",{className:"text-center py-10 text-gray-500",children:"No similar products found. Try uploading a different image."})]}):null}}},e=>{var r=r=>e(e.s=r);e.O(0,[413,497,954,358],()=>r(1717)),_N_E=e.O()}]);